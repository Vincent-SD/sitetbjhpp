{% extends 'base.html.twig' %}

{% block title %}Hello LucioController!{% endblock %}

{% block body %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    </style>

    <div class="example-wrapper">
        <h1>Hello {{ controller_name }}! ✅</h1>

        <label for="textareajson">Entrez du json à parser</label>
        <textarea class="form-control" id="textareajson" rows="3"></textarea>
    </div>
    <div class="row mx-auto justify-content-center ">
        <button id=validjson type="submit" class="btn btn-primary">Valider le json</button>
    </div>
    <div class="mt-5 progress" id="jsonprogress" style="display:none">
        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <div id="onvaparserdujson" class="row mx-auto">

    </div>

    <script type="text/javascript">
        $(document).on('click','#validjson',function (event) {
            let audio  = new Audio('music/onvaparserdujson.wav');
            audio.play();
            $('#jsonprogress').show();
            let lejsonaparse = $('#textareajson').val();
            try{
                let json = JSON.parse(lejsonaparse);
                let i = 0;
                //dev html action p2b notamment
                let progressbar = '<div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>';
                $('#jsonprogress .progress-bar').remove();
                $('#jsonprogress').append(progressbar);
                let interval = setInterval(function(){
                    $('#jsonprogress .progress-bar').attr('aria-valuenow', ++i).css('width', i+'%');
                    if(i === 100){
                        $('#jsonprogress .progress-bar').addClass('bg-success');
                        clearInterval(interval);
                    }
                }, 20);
            } catch(e){
                console.log(e);
            }
        });
    </script>

{% endblock %}
